<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leave Tracker - DA Login</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f6f8;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }

      #auth-section, #calendar-section {
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        width: 350px;
        text-align: center;
      }

      input {
        display: block;
        width: 100%;
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 16px;
      }

      button {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        margin: 10px 5px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
      }

      button:hover {
        background-color: #0056b3;
      }

      #message {
        margin-top: 10px;
        color: red;
      }

      #calendar-section {
        display: none;
      }
    </style>
  </head>

  <body>
    <!-- ðŸ”¹ LOGIN / SIGNUP SECTION -->
    <div id="auth-section">
      <h2>DA Login</h2>
      <input type="email" id="email" placeholder="Email (e.g., kartik@DaTeam)" />
      <input type="password" id="password" placeholder="Password" />
      <button id="signup">Sign Up</button>
      <button id="login">Login</button>
      <p id="message"></p>
    </div>

    <!-- ðŸ”¹ CALENDAR SECTION (after login) -->
    <div id="calendar-section">
      <h2>Welcome, <span id="user-email"></span></h2>
      <button id="logout">Logout</button>
      <div id="calendar">
        <p>Your calendar will appear here after login.</p>
      </div>
    </div>

    <!-- ðŸ”¹ FIREBASE AUTH SCRIPT -->
    <script type="module">
      // Import Firebase SDK
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
      import { 
        getAuth, 
        createUserWithEmailAndPassword, 
        signInWithEmailAndPassword, 
        signOut, 
        onAuthStateChanged 
      } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

      // ðŸ”¹ Your Firebase Config
      const firebaseConfig = {
        apiKey: "AIzaSyA1RfGSJQrfvnGIbyhIStf6O0Sah5uvgj4",
        authDomain: "da-team-leave-tracker.firebaseapp.com",
        projectId: "da-team-leave-tracker",
        storageBucket: "da-team-leave-tracker.firebasestorage.app",
        messagingSenderId: "196149192903",
        appId: "1:196149192903:web:410126d6f56185f9a276e2",
        measurementId: "G-71Q3MGCEBG"
      };

      // ðŸ”¹ Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      // ðŸ”¹ Get DOM elements
      const signupBtn = document.getElementById('signup');
      const loginBtn = document.getElementById('login');
      const logoutBtn = document.getElementById('logout');
      const message = document.getElementById('message');
      const authSection = document.getElementById('auth-section');
      const calendarSection = document.getElementById('calendar-section');
      const userEmailSpan = document.getElementById('user-email');

      // ðŸ”¹ Sign Up
      signupBtn.addEventListener('click', async () => {
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value.trim();
        if (!email || !password) {
          message.textContent = 'Please enter both email and password.';
          return;
        }
        try {
          await createUserWithEmailAndPassword(auth, email, password);
          message.style.color = 'green';
          message.textContent = 'Signup successful! You can now log in.';
        } catch (error) {
          message.style.color = 'red';
          message.textContent = error.message;
        }
      });

      // ðŸ”¹ Login
      loginBtn.addEventListener('click', async () => {
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value.trim();
        if (!email || !password) {
          message.textContent = 'Please enter both email and password.';
          return;
        }
        try {
          await signInWithEmailAndPassword(auth, email, password);
          message.style.color = 'green';
          message.textContent = 'Login successful!';
        } catch (error) {
          message.style.color = 'red';
          message.textContent = error.message;
        }
      });

      // ðŸ”¹ Logout
      logoutBtn.addEventListener('click', async () => {
        await signOut(auth);
      });

      // ðŸ”¹ Show/hide based on login state
      onAuthStateChanged(auth, (user) => {
        if (user) {
          authSection.style.display = 'none';
          calendarSection.style.display = 'block';
          userEmailSpan.textContent = user.email;
        } else {
          authSection.style.display = 'block';
          calendarSection.style.display = 'none';
          userEmailSpan.textContent = '';
        }
      });
    </script>
  </body>
</html>
